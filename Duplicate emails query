

ğğ®ğğ¬ğ­ğ¢ğ¨ğ§:
Table: Person

+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| email       | varchar |
+-------------+---------+
id is the primary key (column with unique values) for this table.
Each row of this table contains an email. The emails will not contain uppercase letters.
 

Write a solution to report all the duplicate emails. Note that it's guaranteed that the email field is not NULL.

Return the result table in any order.

The result format is in the following example.

 

ğ„ğ±ğšğ¦ğ©ğ¥ğ ğŸ:
Input: 
Person table:
+----+---------+
| id | email   |
+----+---------+
| 1  | a@b.com |
| 2  | c@d.com |
| 3  | a@b.com |
+----+---------+
Output: 
+---------+
| Email   |
+---------+
| a@b.com |
+---------+
Explanation: a@b.com is repeated two times.

# ğˆğ§ğ­ğ®ğ¢ğ­ğ¢ğ¨ğ§
By seeing the problem statement I got an idea to count the emails to know how many times it present in the table.

# ğ€ğ©ğ©ğ«ğ¨ğšğœğ¡
So when we count no of times particular emails present in the table then we all know duplicate means 2 or more then I filtered based on the dupliacte condition

# ğ‚ğ¨ğğ
```
ğŸ)ğ€ğ©ğ©ğ«ğ¨ğšğœğ¡ ğ®ğ¬ğ¢ğ§ğ  ğ£ğ¨ğ¢ğ§ğ¬:
As we want to find duplicates from the same table we need to work with that table itself and compare its values using self join.we cant check values of same id we checked for p1.id!=p2.id condition and we checked for same emails existence to avoid duplicates we added distinct keyword to remove duplicates in output

select distinct  p1.email from person p1 join person p2
on p1.email=p2.email
where p1.id!=p2.id

ğŸ)ğ†ğ«ğ¨ğ®ğ©ğ¢ğ§ğ  ğšğ§ğ ğŸğ¥ğ¢ğ­ğğ«ğ¢ğ§ğ  ğšğ©ğ©ğ«ğ¨ğšğœğ¡
Below approach is grouping,counting emails in the table and checking or flitering out emails if emails>=2 then will get only distinct emails with count of emails=1

select email from person group by email 
having count(email)>=2


ğ–ğ«ğ¢ğ­ğ ğš ğ¬ğ¨ğ¥ğ®ğ­ğ¢ğ¨ğ§ ğ­ğ¨ ğğğ¥ğğ­ğ ğšğ¥ğ¥ ğğ®ğ©ğ¥ğ¢ğœğšğ­ğ ğğ¦ğšğ¢ğ¥ğ¬, ğ¤ğğğ©ğ¢ğ§ğ  ğ¨ğ§ğ¥ğ² ğ¨ğ§ğ ğ®ğ§ğ¢ğªğ®ğ ğğ¦ğšğ¢ğ¥ ğ°ğ¢ğ­ğ¡ ğ­ğ¡ğ ğ¬ğ¦ğšğ¥ğ¥ğğ¬ğ­ ğ¢ğ.

For SQL users, please note that you are supposed to write a DELETE statement and not a SELECT one.

For Pandas users, please note that you are supposed to modify Person in place.

After running your script, the answer shown is the Person table. The driver will first compile and run your piece of code and then show the Person table. The final order of the Person table does not matter.

delete p1 from person p1 join person p2 
where p1.email=p2.email and p1.id>p2.id
or
delete p1 from person p1, person p2 
where p1.email=p2.email and p1.id>p2.id
